{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 324e8e02ed210adece0c","webpack:///./src/index.ts","webpack:///./src/store.ts","webpack:///external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"}","webpack:///external {\"root\":\"Rx\",\"commonjs2\":\"rxjs\",\"commonjs\":\"rxjs\",\"amd\":\"rxjs\"}","webpack:///./src/createContext.ts","webpack:///./src/provide.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA,kCAAiC;AACjC;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,GAAE;AACF,mCAAkC;AAClC;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,GAAE;AACF,mCAAkC;AAClC;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,uBAAuB;AACnD;AACA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB,qCAAoC,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA,8CAA6C,gBAAgB;AAC7D;AACA;AACA;AACA;AACA,mDAAkD,gBAAgB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,wFAAuF,kCAAkC,EAAE;AAC3H;AACA,yCAAwC,uBAAuB;AAC/D;AACA;AACA;AACA;AACA;AACA,0BAAyB,IAAI;AAC7B,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,mCAAkC;AAClC;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;AC5RA,gD;;;;;;ACAA,gD;;;;;;ACAA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD,gCAAgC,EAAE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,uBAAuB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,uBAAuB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,qCAAoC,4CAA4C;AAChF;AACA;AACA;AACA;AACA;AACA;;;;;;;ACnHA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C;AAC3C,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,kDAAiD,gDAAgD,EAAE;AACnG,+CAA8C,gDAAgD,EAAE;AAChG;AACA;AACA,kDAAiD,mDAAmD,EAAE;AACtG,+CAA8C,iDAAiD,EAAE;AACjG;AACA,oEAAmE;AACnE;AACA,iHAAgH,uCAAuC,kBAAkB,EAAE;AAC3K;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"reflow.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"), require(\"rxjs\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\", \"rxjs\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Reflow\"] = factory(require(\"react\"), require(\"rxjs\"));\n\telse\n\t\troot[\"Reflow\"] = factory(root[\"React\"], root[\"Rx\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 324e8e02ed210adece0c","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\n__export(require(\"./store\"));\n__export(require(\"./createContext\"));\n__export(require(\"./provide\"));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.ts\n// module id = 0\n// module chunks = 0","\"use strict\";\nvar rxjs_1 = require(\"rxjs\");\n// ---------------------------------------------\n// Tools\n// ---------------------------------------------\nvar observe = function (permit) { return function () {\n    var names = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        names[_i] = arguments[_i];\n    }\n    return permit.observe.apply(permit, names);\n}; };\nvar getState = function (permit) { return function () {\n    var names = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        names[_i] = arguments[_i];\n    }\n    return permit.getState.apply(permit, names);\n}; };\nvar dispatch = function (permit) { return function (action) {\n    return permit.dispatch(action);\n}; };\n// ---------------------------------------------\n// StorePermit\n// ---------------------------------------------\nfunction isPromise(obj) {\n    return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\nvar StorePermit = (function () {\n    function StorePermit(store) {\n        var _this = this;\n        this.store = store;\n        this.hasParent = function () {\n            return _this.store\n                && !_this.store.destroyed\n                && _this.store.hasParent();\n        };\n        this.hasState = function (name) {\n            return _this.store\n                && !_this.store.destroyed\n                && _this.store.hasState(name);\n        };\n        this.isPlainState = function (name) {\n            return _this.store\n                && !_this.store.destroyed\n                && _this.store.isPlainState(name);\n        };\n        this.observe = function () {\n            var names = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                names[_i] = arguments[_i];\n            }\n            if (_this.destroyed) {\n                return rxjs_1.Observable.empty();\n            }\n            var subject = new rxjs_1.BehaviorSubject(null);\n            _this._subjects.push(subject);\n            _this._subscriptions.push((_a = _this.store).observe.apply(_a, names).subscribe(subject));\n            return subject.distinctUntilChanged().debounceTime(1, rxjs_1.Scheduler.queue);\n            var _a;\n        };\n        this.getState = function () {\n            var names = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                names[_i] = arguments[_i];\n            }\n            if (_this.destroyed)\n                return Promise.resolve({});\n            return (_a = _this.store).observe.apply(_a, names).first().toPromise();\n            var _a;\n        };\n        this.dispatch = function (action) {\n            if (typeof action === 'function') {\n                var broken_1 = false;\n                var teardown_1 = action(_this.tools);\n                return function () {\n                    if (!broken_1 && typeof teardown_1 === 'function')\n                        teardown_1();\n                    broken_1 = true;\n                };\n            }\n            else if (isPromise(action)) {\n                var broken_2 = false;\n                Promise.resolve(action).then(function (update) {\n                    if (broken_2)\n                        return;\n                    Object.keys(update).forEach(function (name) {\n                        if (_this.store.isPlainState(name))\n                            _this.store.update(name, update[name]);\n                    });\n                });\n                return function () { return broken_2 = true; };\n            }\n            else {\n                var update_1 = action;\n                Object.keys(update_1).forEach(function (name) {\n                    if (_this.store.isPlainState(name))\n                        _this.store.update(name, update_1[name]);\n                });\n                return function () {\n                };\n            }\n        };\n        this._destroyed = false;\n        this._subjects = [];\n        this._subscriptions = [];\n    }\n    Object.defineProperty(StorePermit.prototype, \"destroyed\", {\n        get: function () {\n            return this._destroyed\n                || !this.store\n                || this.store.destroyed;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StorePermit.prototype, \"tools\", {\n        get: function () {\n            var _this = this;\n            var tools = {\n                observe: observe(this),\n                dispatch: dispatch(this),\n                getState: getState(this),\n            };\n            var storeTools = this.store.tools;\n            Object.keys(storeTools).forEach(function (name) {\n                tools[name] = storeTools[name](_this);\n            });\n            return tools;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    StorePermit.prototype.destroy = function () {\n        for (var _i = 0, _a = this._subjects; _i < _a.length; _i++) {\n            var subject = _a[_i];\n            subject.complete();\n            subject.unsubscribe();\n        }\n        for (var _b = 0, _c = this._subscriptions; _b < _c.length; _b++) {\n            var subscription = _c[_b];\n            subscription.unsubscribe();\n        }\n        this._subjects = null;\n        this._subscriptions = null;\n        this._destroyed = true;\n        this.store = null;\n    };\n    return StorePermit;\n}());\nexports.StorePermit = StorePermit;\n// ---------------------------------------------\n// Store\n// ---------------------------------------------\nvar Store = (function () {\n    function Store(config, parentStore) {\n        var _this = this;\n        this.config = config;\n        this.parentStore = parentStore;\n        this.hasParent = function () {\n            if (_this.parentStore) {\n                if (!_this.parentStore.destroyed) {\n                    return true;\n                }\n                else {\n                    console.error('The parent store has already been destroyed.\\n' +\n                        'This hasParent() should not be executed.\\n' +\n                        'Do not let this hasParent() execute.');\n                    return false;\n                }\n            }\n            else {\n                return false;\n            }\n        };\n        this.hasState = function (name) {\n            // TODO [Test] parent store 까지 검색해서 결과를 알려준다\n            return _this.config.state[name] !== undefined\n                || (_this.parentStore && _this.parentStore.hasState(name));\n        };\n        this.isPlainState = function (name) {\n            return typeof _this.config.state[name] !== 'function';\n        };\n        this.update = function (name, value) {\n            if (_this.config.state[name] !== undefined) {\n                var observable = _this.getObservable(name);\n                if (observable instanceof rxjs_1.Subject)\n                    observable.next(value);\n            }\n            else if (_this.parentStore) {\n                _this.parentStore.update(name, value);\n            }\n        };\n        this.getObservable = function (name) {\n            if (!_this.hasState(name))\n                throw new Error(name + \" is undefined state name...\");\n            if (_this.config.state[name] !== undefined) {\n                if (!_this._observables.has(name)) {\n                    var observable = _this.isPlainState(name)\n                        ? new rxjs_1.BehaviorSubject(_this.config.state[name])\n                        : _this.config.state[name](_this.observe);\n                    _this._observables.set(name, observable);\n                }\n                return _this._observables.get(name);\n            }\n            else if (_this.parentStore) {\n                return _this.parentStore.getObservable(name);\n            }\n        };\n        this.observe = function () {\n            var names = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                names[_i] = arguments[_i];\n            }\n            if (names.length === 1) {\n                return _this.getObservable(names[0])\n                    .map(function (value) {\n                    var states = {};\n                    states[names[0]] = value;\n                    return states;\n                });\n            }\n            else if (names.length > 1) {\n                return rxjs_1.Observable\n                    .combineLatest.apply(rxjs_1.Observable, names.map(function (name) { return _this.getObservable(name); }).concat([function () {\n                        var values = [];\n                        for (var _i = 0; _i < arguments.length; _i++) {\n                            values[_i] = arguments[_i];\n                        }\n                        return values.reduce(function (states, value, i) {\n                            states[names[i]] = value;\n                            return states;\n                        }, {});\n                    }]));\n            }\n            else {\n                throw new Error('names length is 0');\n            }\n        };\n        this._observables = new Map();\n        this._destroyed = false;\n        if (typeof config.startup === 'function') {\n            this._startupPermit = this.access();\n            this._startupTeardown = this._startupPermit.dispatch(this.config.startup);\n        }\n    }\n    Object.defineProperty(Store.prototype, \"destroyed\", {\n        get: function () {\n            return this._destroyed;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Store.prototype, \"tools\", {\n        get: function () {\n            var tools = this.config && this.config.tools ? this.config.tools : {};\n            return this.parentStore\n                ? Object.assign({}, this.parentStore.tools, tools)\n                : tools || {};\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Store.prototype.access = function () {\n        return new StorePermit(this);\n    };\n    Store.prototype.destroy = function () {\n        if (typeof this._startupTeardown === 'function')\n            this._startupTeardown();\n        if (this._startupPermit instanceof StorePermit)\n            this._startupPermit.destroy();\n        this._startupTeardown = null;\n        this._startupPermit = null;\n        this._observables.forEach(function (observable) {\n            if (observable instanceof rxjs_1.Subject) {\n                observable.complete();\n                observable.unsubscribe();\n            }\n        });\n        this._observables.clear();\n        this._destroyed = true;\n    };\n    return Store;\n}());\nexports.Store = Store;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/store.ts\n// module id = 1\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"}\n// module id = 2\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"root\":\"Rx\",\"commonjs2\":\"rxjs\",\"commonjs\":\"rxjs\",\"amd\":\"rxjs\"}\n// module id = 3\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar react_1 = require(\"react\");\nvar store_1 = require(\"./store\");\nvar unavailableNames = ['children', 'parentStore'];\nfunction findUnavailableName(obj) {\n    return unavailableNames.find(function (name) { return obj[name] !== undefined; });\n}\nfunction createContext(config) {\n    var name = findUnavailableName(config.state);\n    if (typeof name === 'string')\n        throw new Error(\"Do not include \\\"\" + name + \"\\\" to \\\"state\\\". unavailable names [\" + unavailableNames.join(', ') + \"]\");\n    var isolated = config.isolate === true;\n    var toChildrenContextTypes = { '_REFLOW_CONTEXT_': react_1.PropTypes.object };\n    var fromParentContextTypes = {};\n    if (!isolated) {\n        toChildrenContextTypes['_REFLOW_PARENT_CONTEXT_'] = react_1.PropTypes.object;\n        fromParentContextTypes['_REFLOW_PARENT_CONTEXT_'] = react_1.PropTypes.object;\n    }\n    var Context = (function (_super) {\n        __extends(Context, _super);\n        function Context() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.getContextProps = function () {\n                return _this.props;\n            };\n            _this.hasParent = function () {\n                return _this.permit.hasParent();\n            };\n            _this.observe = function () {\n                var names = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    names[_i] = arguments[_i];\n                }\n                return (_a = _this.permit).observe.apply(_a, names);\n                var _a;\n            };\n            _this.getState = function () {\n                var names = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    names[_i] = arguments[_i];\n                }\n                return (_a = _this.permit).getState.apply(_a, names);\n                var _a;\n            };\n            _this.dispatch = function (action) {\n                return _this.permit.dispatch(action);\n            };\n            return _this;\n        }\n        Context.prototype.getChildContext = function () {\n            var context = { '_REFLOW_CONTEXT_': this.store };\n            if (!isolated)\n                context['_REFLOW_PARENT_CONTEXT_'] = this.store;\n            return context;\n        };\n        ;\n        Context.prototype.render = function () {\n            // FIXME Allow multiple children elements. However, multiple children are warapped in <div>\n            return react_1.Children.count(this.props.children) > 1\n                ? react_1.createElement('div', null, this.props.children)\n                : this.props.children;\n        };\n        Context.prototype.receiveProps = function (prevProps, nextProps) {\n            var _this = this;\n            Object.keys(nextProps).forEach(function (name) {\n                if (typeof _this.contextProps[name] === 'function' && prevProps[name] !== nextProps[name]) {\n                    _this.contextProps[name](prevProps[name], nextProps[name]);\n                }\n            });\n        };\n        Context.prototype.componentWillMount = function () {\n            // FIXME props를 통해서 parentStore 수동 입력 (다른 frame과 혼합시에 도움이 될듯 싶다)\n            this.store = new store_1.Store(config, this.props.parentStore || this.context._REFLOW_PARENT_CONTEXT_);\n            this.permit = this.store.access();\n            if (typeof config.handleContextProps === 'function') {\n                this.unhandleContextProps = config.handleContextProps(this.permit.tools, this.getContextProps);\n            }\n            if (typeof config.receiveContextProps === 'function') {\n                this.contextProps = config.receiveContextProps(this.permit.tools);\n                var name_1 = findUnavailableName(config.state);\n                if (typeof name_1 === 'string')\n                    throw new Error(\"Do not include \\\"\" + name_1 + \"\\\" to \\\"receiveContextProps\\\". unavailable names [\" + unavailableNames.join(', ') + \"]\");\n                this.receiveProps({}, this.props);\n            }\n        };\n        Context.prototype.componentWillReceiveProps = function (nextProps) {\n            if (this.contextProps) {\n                this.receiveProps(this.props, nextProps);\n            }\n        };\n        Context.prototype.componentWillUnmount = function () {\n            if (typeof this.unhandleContextProps === 'function')\n                this.unhandleContextProps();\n            this.unhandleContextProps = null;\n            this.permit.destroy();\n            this.store.destroy();\n            this.permit = null;\n            this.store = null;\n        };\n        Context.prototype.shouldComponentUpdate = function (nextProps) {\n            return this.props.children !== nextProps.children;\n        };\n        return Context;\n    }(react_1.Component));\n    Context.displayName = \"Context({\" + Object.keys(config.state).join(',') + \"})\";\n    // to children components\n    Context.childContextTypes = toChildrenContextTypes;\n    Context.contextTypes = fromParentContextTypes;\n    return Context;\n}\nexports.createContext = createContext;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/createContext.ts\n// module id = 4\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar rxjs_1 = require(\"rxjs\");\nvar react_1 = require(\"react\");\nfunction provide() {\n    var providers = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        providers[_i] = arguments[_i];\n    }\n    // TODO Support deprecated provide api. This is going to remove in 0.6\n    if (typeof providers[0] === 'function' || typeof providers[1] === 'function') {\n        var legacyProvider = {};\n        if (typeof providers[0] === 'function')\n            legacyProvider.mapState = providers[0];\n        if (typeof providers[1] === 'function')\n            legacyProvider.mapHandlers = providers[1];\n        providers = [legacyProvider];\n    }\n    return function (WrappedComponent) {\n        var Provided = (function (_super) {\n            __extends(Provided, _super);\n            function Provided() {\n                var _this = _super !== null && _super.apply(this, arguments) || this;\n                _this.state = {\n                    drops: null,\n                };\n                return _this;\n            }\n            Provided.prototype.render = function () {\n                return this.state.drops && this.dropState\n                    ? react_1.createElement(WrappedComponent, this.state.drops)\n                    : null;\n            };\n            Provided.prototype.updateDrops = function (props) {\n                this.setState({\n                    drops: Object.assign({}, props, this.dropState, this.dropHandlers)\n                });\n            };\n            Provided.prototype.componentWillMount = function () {\n                var _this = this;\n                this.permit = this.context._REFLOW_CONTEXT_.access();\n                var mapState = providers\n                    .filter(function (provider) { return typeof provider.mapState === 'function'; })\n                    .map(function (provider) { return provider.mapState(_this.permit.observe); })\n                    .reverse();\n                var mapHandler = providers\n                    .filter(function (provider) { return typeof provider.mapHandlers === 'function'; })\n                    .map(function (provider) { return provider.mapHandlers(_this.permit.tools); })\n                    .reverse();\n                this.dropHandlers = Object.assign.apply(Object, [{}].concat(mapHandler));\n                this.subscription = mapState.length > 0\n                    ? rxjs_1.Observable.combineLatest.apply(rxjs_1.Observable, mapState).map(function (states) { return Object.assign.apply(Object, [{}].concat(states)); })\n                        .subscribe(function (state) {\n                        _this.dropState = state;\n                        _this.updateDrops(_this.props);\n                    })\n                    : null;\n            };\n            Provided.prototype.componentWillReceiveProps = function (nextProps) {\n                this.updateDrops(nextProps);\n            };\n            Provided.prototype.componentWillUnmount = function () {\n                if (this.subscription)\n                    this.subscription.unsubscribe();\n                this.permit.destroy();\n                this.subscription = null;\n                this.permit = null;\n                this.dropHandlers = null;\n                this.dropState = null;\n            };\n            Provided.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n                return this.state.drops !== nextState.drops;\n            };\n            return Provided;\n        }(react_1.Component));\n        Provided.displayName = \"Provided(\" + (WrappedComponent.displayName || WrappedComponent.name) + \")\";\n        Provided.contextTypes = {\n            _REFLOW_CONTEXT_: react_1.PropTypes.object,\n        };\n        return Provided;\n    };\n}\nexports.provide = provide;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/provide.ts\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}