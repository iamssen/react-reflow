!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("rxjs"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","rxjs","react-dom"],e):"object"==typeof exports?exports.Reflow=e(require("react"),require("rxjs"),require("react-dom")):t.Reflow=e(t.React,t.Rx,t.ReactDOM)}(this,function(t,e,r){return function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,o){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=11)}([function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e,r){"use strict";function o(t){u.checkRestrictedPropNames(t.state,function(t,e){return"Do not inlcude "+t+' to "state", Restricted prop names are ['+e.join(", ")+"]"});var r=t.isolate===!0,o={_REFLOW_CONTEXT_:s.PropTypes.object},a={};r||(o._REFLOW_PARENT_CONTEXT_=s.PropTypes.object,a._REFLOW_PARENT_CONTEXT_=s.PropTypes.object);var c=function(o){function a(){var t=null!==o&&o.apply(this,arguments)||this;return t.getContextProps=function(){return t.props},t.hasParent=function(){return t.permit.hasParent()},t.hasState=function(e){return t.permit.hasState(e)},t.isPlainState=function(e){return t.permit.isPlainState(e)},t.observe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(o=t.permit).observe.apply(o,e);var o},t.getState=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(o=t.permit).getState.apply(o,e);var o},t.dispatch=function(e){return t.permit.dispatch(e)},t}return n(a,o),a.prototype.getChildContext=function(){var t={_REFLOW_CONTEXT_:this.store};return r||(t._REFLOW_PARENT_CONTEXT_=this.store),t},a.prototype.render=function(){return s.Children.count(this.props.children)>1?s.createElement("div",null,this.props.children):this.props.children},a.prototype.receiveProps=function(t,e){var r=this;Object.keys(e).forEach(function(o){"function"==typeof r.contextProps[o]&&t[o]!==e[o]&&r.contextProps[o](t[o],e[o])})},a.prototype.componentWillMount=function(){this.store=new i.Store(t,this.props.parentStore||this.context._REFLOW_PARENT_CONTEXT_),this.permit=this.store.access(),e.mountedStores.add(this.store),"function"==typeof t.handleContextProps&&(this.unhandleContextProps=t.handleContextProps(this.permit.tools,this.getContextProps)),"function"==typeof t.receiveContextProps&&(this.contextProps=t.receiveContextProps(this.permit.tools),u.checkRestrictedPropNames(this.contextProps,function(t,e){return"Do not inlcude "+t+' to "receiveContextProps", Restricted prop names are ['+e.join(", ")+"]"}),this.receiveProps({},this.props))},a.prototype.componentWillReceiveProps=function(t){this.contextProps&&this.receiveProps(this.props,t)},a.prototype.componentWillUnmount=function(){e.mountedStores.has(this.store)&&e.mountedStores.delete(this.store),"function"==typeof this.unhandleContextProps&&this.unhandleContextProps(),this.unhandleContextProps=null,this.permit.destroy(),this.store.destroy(),this.permit=null,this.store=null},a.prototype.shouldComponentUpdate=function(t){return this.props.children!==t.children},a}(s.Component);return c.displayName="Context({"+Object.keys(t.state).join(",")+"})",c.childContextTypes=o,c.contextTypes=a,c}var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=r(0),i=r(4),u=r(5);e.mountedStores=new Set,e.createContext=o},function(t,e,r){"use strict";function o(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then}Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),s=function(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.observe.apply(t,e)}},i=function(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.getState.apply(t,e)}},u=function(t){return function(e){return t.dispatch(e)}},a=function(){function t(t){var e=this;this.store=t,this.hasParent=function(){return e._destroyed?(console.error("StorePermit이 파괴된 이후엔 StorePermit.hasParent()가 호출되면 안됨. 확인해서 지울것."),!1):e.store&&e.store.destroyed?(console.error("Store가 파괴된 이후엔 StorePermit.hasParent()가 호출되면 안됨. 확인해서 지울것."),!1):e.store&&!e.store.destroyed&&e.store.hasParent()},this.hasState=function(t){return e._destroyed?(console.error("StorePermit이 파괴된 이후엔 StorePermit.hasState()가 호출되면 안됨. 확인해서 지울것."),!1):e.store&&e.store.destroyed?(console.error("Store가 파괴된 이후엔 StorePermit.hasState()가 호출되면 안됨. 확인해서 지울것."),!1):e.store&&!e.store.destroyed&&e.store.hasState(t)},this.isPlainState=function(t){return e._destroyed?(console.error("StorePermit이 파괴된 이후엔 StorePermit.isPlainState()가 호출되면 안됨. 확인해서 지울것."),!1):e.store&&e.store.destroyed?(console.error("Store가 파괴된 이후엔 StorePermit.isPlainState()가 호출되면 안됨. 확인해서 지울것."),!1):e.store&&!e.store.destroyed&&e.store.isPlainState(t)},this.observe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(e._destroyed)return console.error("StorePermit이 파괴된 이후엔 StorePermit.observe()가 호출되면 안됨. 확인해서 지울것."),n.Observable.empty();if(e.store&&e.store.destroyed)return console.error("Store가 파괴된 이후엔 StorePermit.observe()가 호출되면 안됨. 확인해서 지울것."),n.Observable.empty();var o=new n.BehaviorSubject(null);return e._subjects.push(o),e._subscriptions.push((s=e.store).observe.apply(s,t).subscribe(o)),o.distinctUntilChanged().debounceTime(1,n.Scheduler.queue);var s},this.getState=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e._destroyed?(console.error("StorePermit이 파괴된 이후엔 StorePermit.getState()가 호출되면 안됨. 확인해서 지울것."),Promise.resolve({})):e.store&&e.store.destroyed?(console.error("Store가 파괴된 이후엔 StorePermit.getState()가 호출되면 안됨. 확인해서 지울것."),Promise.resolve({})):(o=e.store).observe.apply(o,t).first().toPromise();var o},this.dispatch=function(t){if(e._destroyed)return void console.error("StorePermit이 파괴된 이후엔 StorePermit.dispatch()가 호출되면 안됨. 확인해서 지울것.");if(e.store&&e.store.destroyed)return void console.error("Store가 파괴된 이후엔 StorePermit.dispatch()가 호출되면 안됨. 확인해서 지울것.");if("function"==typeof t){var r=!1,n=t(e.tools);return function(){r||"function"!=typeof n||n(),r=!0}}if(o(t)){var s=!1;return Promise.resolve(t).then(function(t){s||e.destroyed||Object.keys(t).forEach(function(r){e.store.isPlainState(r)&&e.store.update(r,t[r])})}),function(){return s=!0}}var i=t;return Object.keys(i).forEach(function(t){e.store.isPlainState(t)&&e.store.update(t,i[t])}),function(){}},this.destroy=function(){if(e._destroyed)return void console.error("StorePermit.destroy() can not be executed multiple times. Find and delete redundant code.");for(var t=0,r=e._subjects;t<r.length;t++){var o=r[t];o.complete(),o.unsubscribe()}for(var n=0,s=e._subscriptions;n<s.length;n++){var i=s[n];i.unsubscribe()}e._subjects=null,e._subscriptions=null,e._destroyed=!0,e.store=null},this._destroyed=!1,this._subjects=[],this._subscriptions=[]}return Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed||!this.store||this.store.destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tools",{get:function(){var t=this;if(this._destroyed)return console.error("StorePermit이 파괴된 이후엔 StorePermit.tools가 호출되면 안됨. 확인해서 지울것."),null;if(this.store&&this.store.destroyed)return console.error("Store가 파괴된 이후엔 StorePermit.tools가 호출되면 안됨. 확인해서 지울것."),null;var e={observe:s(this),dispatch:u(this),getState:i(this)},r=this.store.tools;return Object.keys(r).forEach(function(o){e[o]=r[o](t)}),e},enumerable:!0,configurable:!0}),t}();e.StorePermit=a},function(t,e,r){"use strict";function o(t){var e=Object.keys(t);if(0===e.length)return{};var r=["dispatch","observe","getState"];return e.filter(function(t){return r.indexOf(t)===-1}).reduce(function(e,r){return e[r]=t[r],e},{})}Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),s=r(3),i=r(5),u=r(6),a=function(){function t(t,e){var r=this;this.config=t,this.parentStore=e,this.hasParent=function(){return r._destroyed?(console.error("Store 파괴 이후엔 hasParent()가 호출되면 안됨. 찾아서 삭제할 것."),!1):!!r.parentStore&&(!r.parentStore.destroyed||(console.error("The parent store has already been destroyed.\nThis hasParent() should not be executed.\nDo not let this hasParent() execute."),!1))},this.hasState=function(t){return r._destroyed?(console.error("Store 파괴 이후엔 hasState()가 호출되면 안됨. 찾아서 삭제할 것."),!1):void 0!==r.config.state[t]||r.parentStore&&r.parentStore.hasState(t)},this.isPlainState=function(t){if(r._destroyed)return console.error("Store 파괴 이후엔 isPlainState()가 호출되면 안됨. 찾아서 삭제할 것."),!1;if(!r.hasState(t))throw new Error('"'+t+'"은 찾을 수 없는 state name이다.');return void 0!==r.config.state[t]?"function"!=typeof r.config.state[t]:r.parentStore?r.parentStore.isPlainState(t):void 0},this.update=function(t,e){if(r._destroyed)return void console.error("Store 파괴 이후에는 update()가 호출되면 안됨. 찾아서 삭제할 것.");if(!r.hasState(t))throw new Error('"'+t+'"은 찾을 수 없는 state name이다.');if(!r.isPlainState(t))throw new Error('"'+t+'"은 Plain State가 아니기 때문에 update 할 수 없다.');if(void 0!==r.config.state[t]){var o=r.getObservable(t);o instanceof n.Subject&&o.next(e)}else r.parentStore&&r.parentStore.update(t,e)},this.getObservable=function(t){if(r._destroyed)return console.error("Store 파괴 이후 getObservable()이 호출되면 안됨. 찾아서 삭제할 것."),n.Observable.empty();if(!r.hasState(t))throw new Error('"'+t+'" is a state name that can not be found.');if(void 0!==r.config.state[t]){if(!r._observables.has(t)){var e=r.isPlainState(t)?new n.BehaviorSubject(r.config.state[t]):r.config.state[t](r.observe);r._observables.set(t,e)}return r._observables.get(t)}return r.parentStore?r.parentStore.getObservable(t):void 0},this.observe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(r._destroyed)return console.error("Store 파괴 이후 observe()는 호출되면 안됨. 찾아서 삭제할 것."),n.Observable.empty();if(1===t.length)return r.getObservable(t[0]).map(function(e){var r={};return r[t[0]]=e,r});if(t.length>1)return n.Observable.combineLatest.apply(n.Observable,t.map(function(t){return r.getObservable(t)}).concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.reduce(function(e,r,o){return e[t[o]]=r,e},{})}]));throw new Error("names length is 0")},this.access=function(){return r._destroyed?null:new s.StorePermit(r)},this.destroy=function(){return r._destroyed?void console.error("Store.destroy() can not be executed multiple times. Find and delete redundant code."):("function"==typeof r._startupTeardown&&r._startupTeardown(),r._startupPermit instanceof s.StorePermit&&r._startupPermit.destroy(),r._startupTeardown=null,r._startupPermit=null,r._observables.forEach(function(t){t instanceof n.Subject&&(t.complete(),t.unsubscribe())}),r._observables.clear(),void(r._destroyed=!0))},i.checkRestrictedPropNames(t.state,function(t,e){return"Do not inlcude "+t+' to "state", Restricted prop names are ['+e.join(", ")+"]"}),this._observables=new Map,this._destroyed=!1,"function"==typeof t.startup&&(this._startupPermit=this.access(),this._startupTeardown=this._startupPermit.dispatch(this.config.startup))}return t.prototype[u.getParentStore]=function(){return this.parentStore},t.prototype[u.getConfig]=function(){return this.config},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tools",{get:function(){if(this._destroyed)return console.error("Store 파괴 이후엔 tools가 호출되면 안됨. 찾아서 삭제할 것."),null;var t=this.config&&this.config.tools?this.config.tools:{};return this.parentStore?Object.assign({},o(this.parentStore.tools),t):t||{}},enumerable:!0,configurable:!0}),t}();e.Store=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=["children","parentStore"];e.checkRestrictedPropNames=function(t,e){var r=o.find(function(e){return void 0!==t[e]});if("string"==typeof r)throw new Error(e(r,o))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getParentStore=Symbol("getParentStore"),e.getConfig=Symbol("getConfig")},function(t,e,r){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),s=r(10),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getChildContext=function(){return{_REFLOW_CONTEXT_:this.props.context,_REFLOW_PARENT_CONTEXT_:this.props.parentContext}},e.prototype.render=function(){return this.props.children},e.prototype.shouldComponentUpdate=function(t){return this.props.context!==t.context||this.props.parentContext!==t.parentContext},e}(n.Component);i.childContextTypes={_REFLOW_CONTEXT_:n.PropTypes.object,_REFLOW_PARENT_CONTEXT_:n.PropTypes.object};var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderComponent=function(t,r){return s.render(n.createElement(i,{context:e.context._REFLOW_CONTEXT_,parentContext:e.context._REFLOW_PARENT_CONTEXT_},t),r),function(){s.unmountComponentAtNode(r),r.parentElement.removeChild(r)}},e}return o(e,t),e.prototype.render=function(){return null},e}(n.Component);u.contextTypes={_REFLOW_CONTEXT_:n.PropTypes.object,_REFLOW_PARENT_CONTEXT_:n.PropTypes.object},e.ContextLinker=u},function(t,e,r){"use strict";function o(){var t=[],e=new Map;return s.mountedStores.forEach(function(r){var o=r[i.getParentStore](),n=r[i.getConfig](),s={store:r,state:Object.keys(n.state)};e.set(r,s),o||t.push(s)}),e.forEach(function(t,r){var o=r[i.getParentStore]();if(e.has(o)){var n=e.get(o);n.children||(n.children=[]),n.children.push(t)}}),{root:t,nodes:e}}function n(t){function e(r,o,n){void 0===o&&(o=0),console.log(Array(o).slice().fill(t).join(""),u.get(r.store)),r.children&&r.children.forEach(function(t){return e(t,o+1,n)})}void 0===t&&(t="   ");var r=o(),n=r.root,s=r.nodes,i=[],u=new Map;s.forEach(function(t){i.push((e=t.store).observe.apply(e,t.state).first().toPromise().then(function(e){u.set(t.store,e)}));var e}),Promise.all(i).then(function(){var t=[];n.forEach(function(r){return e(r,0,t)})})}Object.defineProperty(e,"__esModule",{value:!0});var s=r(2),i=r(6);window&&(window.getReflowContext=o,window.printReflowState=n)},function(t,e,r){"use strict";function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("function"==typeof t[0]||"function"==typeof t[1]){var r={};"function"==typeof t[0]&&(r.mapState=t[0]),"function"==typeof t[1]&&(r.mapHandlers=t[1]),t=[r]}return function(e){var r=function(r){function o(){var t=null!==r&&r.apply(this,arguments)||this;return t.state={drops:null},t}return n(o,r),o.prototype.render=function(){return this.state.drops&&this.dropState?i.createElement(e,this.state.drops):null},o.prototype.updateDrops=function(t){this.setState({drops:Object.assign({},t,this.dropState,this.dropHandlers)})},o.prototype.componentWillMount=function(){var e=this;this.permit=this.context._REFLOW_CONTEXT_.access();var r=t.filter(function(t){return"function"==typeof t.mapState}).map(function(t){return t.mapState(e.permit.observe)}),o=t.filter(function(t){return"function"==typeof t.mapHandlers}).map(function(t){return t.mapHandlers(e.permit.tools)});this.dropHandlers=Object.assign.apply(Object,[{}].concat(o)),r.length>0?this.subscription=s.Observable.combineLatest.apply(s.Observable,r).map(function(t){return Object.assign.apply(Object,[{}].concat(t))}).subscribe(function(t){e.dropState=t,e.updateDrops(e.props)}):(this.dropState={},this.updateDrops(this.props))},o.prototype.componentWillReceiveProps=function(t){this.updateDrops(t)},o.prototype.componentWillUnmount=function(){this.subscription&&this.subscription.unsubscribe(),this.permit.destroy(),this.subscription=null,this.permit=null,this.dropHandlers=null,this.dropState=null},o.prototype.shouldComponentUpdate=function(t,e){return this.state.drops!==e.drops},o}(i.Component);return r.displayName="Provided("+(e.displayName||e.name)+")",r.contextTypes={_REFLOW_CONTEXT_:i.PropTypes.object},r}}var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=r(1),i=r(0);e.provide=o},function(t,e){t.exports=r},function(t,e,r){"use strict";function o(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),o(r(4)),o(r(3)),o(r(2)),o(r(9)),o(r(7)),r(8)}])});